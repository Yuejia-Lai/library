# **信息的表示和处理**

> [!tip] 本章节讲述了计算机存储数字与字符的方法（包括各种整型，无符号数，浮点数等），也讲述推导了相关运算以及其满足的性质

现代计算机用二进制来表示存储信息，称为位（bit），本章节主要介绍三种数字表示：无符号编码，补码编码，浮点数编码

> [!note] 计算机表示法是用有限的位来表示一个数字，这样会导致一些“溢出”和“精确度”的问题，就算是这样，整数运算以及其他数字运算仍然满足某些数学定理，浮点数是其中比较特殊的一类，和整数不同，整数范围比较小但是精确，浮点数范围大但是不精确

> Java语言创造了一套新的数字运算和表示标准，C/C++在数字表示和运算上有多种形式（具体取决于机器类型），但是Java对其有严格的标准

---

## 信息存储

- 计算机大多使用八位的“块”，称为“字节”，来作为最小的可寻址的内存单位
- 机器程序将内存视为一个巨大的字节数组，称为“虚拟内存”，每个字节有唯一的内存地址，它们构成了“虚拟地址空间”
- 每个字节对象可以简单地视为一个字节块，而程序本身就是一个字节序列

### 十六进制表示法

一个字节由八位组成，二进制表示冗长，十进制与二进制转换麻烦，所以可以使用十六进制数来表示位模式，由‘0’-‘9’以及‘A’-‘F’来表示。

> [!tip] 十六进制二进制转化：
>
> - 二进制数据拆成四个一组，最高位组不足四个则用0补齐
> - 将每一组转换为十六进制数
> - 十六进制转换二进制同理

### 字数据大小

每台计算机都有**字长**，标明指针数据的大小，也是虚拟地址的取值范围（现在的64位机器，32位机器），虚拟地址范围为：$$[0，2^w-1(w为字长)]$$

> 事实上，大多数64位机器也可以兼容32位程序，这是一种向后兼容，而且现在很多编译器也可以指定以哪种字长编译
>
> 从基本数据类型来看，这两种字长最大的区别在于long类型是4字节还是8字节（以及char*类型）

### 寻址和字节顺序

- 几乎在所有机器中，多字节对象被存储为连续的字节序列，对象地址为所使用的字节中最小的地址
- 某些机器在内存中按照从最低有效字节到最高有效字节进行存储，称为“小端法”，而另一种反过来的表示方法称为“大端法”
- 大多数Intel兼容机使用小端法，许多新的微处理器是“双端法”，但是一旦选择了特定操作系统，字节顺序也就固定了
- 对于大多数应用程序员，字节顺序不可见，特别的是，在网络应用程序的代码方面必须遵守已建立的关于字节顺序的规则

### 表示字符串

C语言中字符串被表示成一个以null结尾的字符数组，Java语言使用Unicode编码字符串

### 表示代码

相同的代码，在不同的机器（操作系统）上编译结果是不一样的，由于指令不兼容，编码方式不同，导致二进制代码不兼容

### 布尔代数简介

其中位向量一个很有用的应用就是表示有限集合，|和&对应于并和交，所以可以用来对集合编码

### C语言中的位级运算

&（and），|（or），^（异或），~（not）

一个常见用法是实现掩码运算

### C语言中的逻辑运算

&&，||，！

> [!attention] 注意与按位运算区分

### C语言中的移位运算

注意区分逻辑右移和算术右移，左移只有一种，C/C++里面大部分用算术右移，Java中可以由程序员指定

---



## 整数表示

整数编码有两种方式：无符号和有符号

### 整型数据类型

32位程序：

![20180326064340173](https://s2.loli.net/2022/07/19/jzQxvi6DTuaNILE.jpg)

64位程序：

![v2-e03fde0d3ab0c4b360ca7647878a7f80_r](https://s2.loli.net/2022/07/19/cByjCoYXgEzt5Wh.jpg)

可以看到，主要区别在于long类型（当然还有指针类型）大小范围不一样

C语言整型数据类型的保证的取值范围，C语言标准要求这些数据类型必须至少具有这样的取值范围：

![2018032606472465](https://s2.loli.net/2022/07/19/OqQFpLDVwyr8Tm5.jpg)

除了固定大小的数据类型，可以看出来，C语言要求正数与负数范围对称

> [!note] C/C++都支持有符号数和无符号数，Java不支持无符号数

### 无符号数的编码

假设有w位，将其看作是一个二进制数，就得到了无符号表示

所以无符号数的范围是：$$[0 - 2^w-1]$$ 

**无符号数编码具有唯一性**

### 补码编码

**计算机表示有符号数最常见的形式**

> 在补码定义中，字的最高位解释为负权值，同时最高位也被称为符号位，为1的时候是负数，为0时是正数

所以，w位补码表示有符号数的范围是：$$[-2^{w-1},2^{w-1}-1]$$

同时，与无符号数一样，**补码编码具有唯一性**

> [!attention] 补码表示的正负数范围不一致，这是导致程序出bug的一大原因，平时应注意

> Java语言中的标准很明确，对整数采用补码表示，这是为了Java的跨平台特性和可移植性

关于“原码和反码”，由于这两种表示方式会导致有+0与-0之分，现在大多数机器都采用补码表示整数，反码唯一不同点是最高位权值比补码少一

### 有符号数与无符号数之间的转换

原则是：数值可能改变，但是位值不变（位模式不变），下面的图表示了转换中数值的变化：

![12](https://s2.loli.net/2022/07/19/jC1UWf9GMcDqXgb.png)

### C语言中的有符号数与无符号数

当C语言执行一个运算时，一个数是有符号，另一个是无符号数，那么会隐式地将有符号数转换为无符号数（在进行<和>比较时，可能会产生问题）

### 拓展一个数字的位表示

- 无符号数的零拓展：在表示的开头添加零即可
- 补码数的符号拓展：在表示的开头添加原数最高有效位的值（这样会让补码数保持原有的数值）

### 截断数字

当计算机将w位数字截断为k位数字时，会直接丢弃高w-k位，截断一个数很可能会改变它的值，在这个例子中表现为对2的k次方取模

### 有符号数与无符号数的建议

**建议不使用或者减少使用无符号数！！！**
